<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="chevreul">
<title>Visualization • chevreul</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualization">
<meta property="og:description" content="chevreul">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">chevreul</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/integration.html">Integration of Seurat objects</a>
    <a class="dropdown-item" href="../articles/pipeline.html">Pipeline</a>
    <a class="dropdown-item" href="../articles/preprocessing.html">Preprocessing</a>
    <a class="dropdown-item" href="../articles/shiny_app.html">Shiny App</a>
    <a class="dropdown-item" href="../articles/visualization.html">Visualization</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cobriniklab/chevreul/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Visualization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cobriniklab/chevreul/blob/HEAD/vignettes/articles/visualization.Rmd" class="external-link"><code>vignettes/articles/visualization.Rmd</code></a></small>
      <div class="d-none name"><code>visualization.Rmd</code></div>
    </div>

    
    
<p>This article demonstrates the visualization tools in Chevreul. We’ll
introduce included functions, their usage, and resulting plots</p>
<p>First step is to load Chevreul package and all other packages
required</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cobriniklab/chevreul" class="external-link">chevreul</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Chevreul contains many plotting functions that allows for
visualization, these plots can be customized for interactive or
non-interactive display.</p>
<div class="section level2">
<h2 id="plot-expression">Plot expression<a class="anchor" aria-label="anchor" href="#plot-expression"></a>
</h2>
<p>Expression of one or more features (genes or transcripts) can be
plotted on a given embedding, resulting in an interactive, single or
multi-feature plot.</p>
<p>When plotting only one feature, output is identical to
<code><a href="https://satijalab.org/seurat/reference/FeaturePlot.html" class="external-link">Seurat::FeaturePlot</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_feature.html">plot_feature</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>,</span>
<span>  embedding <span class="op">=</span> <span class="st">"umap"</span>,</span>
<span>  features <span class="op">=</span> <span class="st">"NRL"</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>If multiple features are to be plotted, the joint density of all the
features are plotted using a <code>plot_density</code> function from the
R package <code>Nebulosa</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_feature.html">plot_feature</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, embedding <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NRL"</span>, <span class="st">"RHO"</span><span class="op">)</span>, return_plotly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>An interactive output plot can be generated by specifying
<code>return_plotly = TRUE</code> which uses <code>ggplotly</code>
allowing identification of individual cells for further
investigation.</p>
<div class="section level3">
<h3 id="plot-read-count-or-other-qc-measurements">Plot read count or other QC measurements<a class="anchor" aria-label="anchor" href="#plot-read-count-or-other-qc-measurements"></a>
</h3>
<p>The <code>plot_readcount</code> function displays a histogram of cell
read counts colored according to a categorical variable using the
argument <code>color.by</code>. Here we can see that read counts for
this dataset are not distinctly different depending on the method of
organoid preparation used (Kuwahara or Zhong)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_readcount.html">plot_readcount</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, metavar <span class="op">=</span> <span class="st">"nCount_RNA"</span>, </span>
<span>               color.by <span class="op">=</span> <span class="st">"Prep.Method"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h3>
<p>Chevreul contains a function that produces an interactive scatter
plot of a metadata variable, where each point in the plot represents a
cell whose position on the plot is given by the cell embedding
determined by the dimensional reduction technique. The default dimension
reduction used is “UMAP”. The group argument in <code><a href="../reference/plot_var.html">plot_var()</a></code>
function allows the user to enter the metadata variable by which to
group the cells by, its default value is set to “batch”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_var.html">plot_var</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, group <span class="op">=</span> <span class="st">"type"</span>, embedding <span class="op">=</span> <span class="st">"umap"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>This function utilizes a Seurat function, <code><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot()</a></code>, as
sub function which produces the dimensional reduction plot.The
interactive parameter, <code>return_plotly</code>, in plot_var when set
to TRUE will convert the plot into an interactive plot using ggplotly
function from R’s plotly package</p>
</div>
<div class="section level3">
<h3 id="plot-cluster-marker-genes">Plot cluster marker genes<a class="anchor" aria-label="anchor" href="#plot-cluster-marker-genes"></a>
</h3>
<p>Marker genes of louvain clusters or additional experimental metadata
can be plotted using <code>plot_markers</code>. This allows
visualization of n marker features grouped by the metadata of interest.
Marker genes are identified using wilcoxon rank-sum test as implemented
in <code>presto</code>. In the resulting dot plot the size of the dot
corresponds to the percentage of cells expressing the feature in each
cluster and the color represents the average expression level of the
feature.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_markers.html">plot_markers</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, metavar <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span>, </span>
<span>             marker_method <span class="op">=</span> <span class="st">"presto"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="violin-plot">Violin plot<a class="anchor" aria-label="anchor" href="#violin-plot"></a>
</h3>
<p>To visualize the distribution of expression level of a feature in
different groups of cells Chevreul draws a violin plot. This function
uses Seurat’s <code>VInPlot()</code> function as a sub-function to
create the violin plot, where the metadata variable, provided to the
function through the variable <code>plot_var</code>, is used to group
the cells and based on the level of feature expression a violin plot is
produced.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_violin.html">plot_violin</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, plot_var <span class="op">=</span> <span class="st">"type"</span>, features <span class="op">=</span> <span class="st">"NRL"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="ploting-all-transcripts">Ploting all transcripts<a class="anchor" aria-label="anchor" href="#ploting-all-transcripts"></a>
</h3>
<p>This function plots the expression level of all the transcripts
present in a given Seurat object, coding for a feature/gene of interest.
The gene of interest is specified by the argument ‘features’ and by
default the data is superimposed on UMAP embedding.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_all_transcripts.html">plot_all_transcripts</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, features <span class="op">=</span> <span class="st">"NRL"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="ploting-transcrpit-composition">Ploting transcrpit composition<a class="anchor" aria-label="anchor" href="#ploting-transcrpit-composition"></a>
</h3>
<p>This Chevreul function produces a visual representation of the
expression levels of each transcript in a gene map. The function
plot_transcript_composition() plots the proportion of reads of a given
gene map to each transcript. The gene of interest is specified by the
argument ‘gene_symbol’.</p>
<p><img src="visualization_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="ploting-ridge-plots-for-cell-cycle-scoring">Ploting ridge plots for cell cycle scoring<a class="anchor" aria-label="anchor" href="#ploting-ridge-plots-for-cell-cycle-scoring"></a>
</h3>
<p>The plot_ridge() function in Chevreul plots a ridge plot for cell
cycle scoring of a feature, providing a visual representation of
expression level of the feature in each cell cycle. This function uses
two embedded Seurat functions. The function CellCycleScoring() assigns
each cell a score based on its expression of G2/M and S phase markers.
This data is then used by the function, RidgePlot(), which uses user
provided ‘features’ argument to plot the ridge plot of the features.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_cell_cycle_distribution.html">plot_cell_cycle_distribution</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, <span class="st">"NRL"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_cell_cycle_distribution.html">plot_cell_cycle_distribution</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, <span class="st">"nFeature_RNA"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-11-2.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="plot-complex-heatmap-from-seurat-object">Plot Complex heatmap from Seurat object<a class="anchor" aria-label="anchor" href="#plot-complex-heatmap-from-seurat-object"></a>
</h3>
<p>The Chevreul function plots an annotated complex heat map from the
Seurat object with a dendogram added to the left side and the top.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/seu_complex_heatmap.html">seu_complex_heatmap</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, features <span class="op">=</span> <span class="va">top_10_features</span>, </span>
<span>                    group.by <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seu_complex_heatmap.html">seu_complex_heatmap</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, features <span class="op">=</span> <span class="va">top_10_features</span>, </span>
<span>                    group.by <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span>, col_arrangement <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-12-2.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seu_complex_heatmap.html">seu_complex_heatmap</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, features <span class="op">=</span> <span class="va">top_10_features</span>, </span>
<span>                    group.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prep.Method"</span>, <span class="st">"gene_snn_res.0.2"</span><span class="op">)</span>, </span>
<span>                    col_arrangement <span class="op">=</span> <span class="st">"gene_snn_res.0.2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-12-3.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seu_complex_heatmap.html">seu_complex_heatmap</a></span><span class="op">(</span><span class="va">human_gene_transcript_seu</span>, features <span class="op">=</span> <span class="va">top_10_features</span>, </span>
<span>                    group.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prep.Method"</span>, <span class="st">"gene_snn_res.0.2"</span><span class="op">)</span>, </span>
<span>                    col_arrangement <span class="op">=</span> <span class="st">"Prep.Method"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualization_files/figure-html/unnamed-chunk-12-4.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Stachelek, Bhavana Bhat.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
